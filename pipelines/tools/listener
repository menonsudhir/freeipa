@Library('idm-ci')
import idmci.*

env.IDMCI_GITREPO = 'https://gitlab.cee.redhat.com/identity-management/idm-ci.git'
env.IDMCI_BRANCH = 'production'
env.IPA_EMAIL = 'ipa-and-samba-team-automation@redhat.com'
env.ANSIBLE_GATHER_TIMEOUT = '60'


properties([
    parameters([
    string(name: 'CI_MESSAGE', defaultValue: '', description: 'CI_MESSAGE'),
    string(name: 'MESSAGE_HEADERS', defaultValue: '', description: 'MESSAGE_HEADERS')
    ]),
    pipelineTriggers([
    [
        $class: 'CIBuildTrigger',
        noSquash: false,
        providerData: [
        $class: 'ActiveMQSubscriberProviderData',
        checks: [
            [expectedValue: '^ready$', field: '$.state_name'],
        ],
        name: 'Red Hat UMB',
        overrides: [
            topic: 'Consumer.rh-jenkins-ci-plugin.61e2edb7-37f3-46a2-81b9-88b4f4b14a78.VirtualTopic.eng.mbs.module.state.change'
        ],
        selector: '',
        timeout: null
        ]
    ]
    ])
])

node {
    print("${params.CI_MESSAGE}")
}
